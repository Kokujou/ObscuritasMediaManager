@inherits ElementBase

@inject IJSRuntime JS
@inject AudioService Audio

<div id="audio-tile-base">
    <div id="audio-tile-container"
         @onclick="@(() => Toggled.InvokeAsync())">
        <div id="audio-image"
             invisible="@(Visualize && !Paused)"
             icon="@(Paused ? Icons.Play : Icons.Pause )"
             @onclick="@(()=>ImageClicked.InvokeAsync())"
        @onclick:preventDefault
        @onclick:stopPropagation></div>
        <canvas id="audio-visualization"
             invisible="@(Paused || !Visualize)" 
             ></canvas>
        <div id="language-icon"
             Language="@(Track.Language)"
             disabled="@(Disabled)"
             @onclick="@(() => ChangeLanguage.InvokeAsync())"></div>
        <div id="nation-icon"
             Nation="@(Track.Nation)"
             disabled="@(Disabled)"
             @onclick="@(() => ChangeLanguage.InvokeAsync())"></div>
        <div disabled="@(Disabled)"
             @onclick="@(() => NextParticipants.InvokeAsync())"
             id="participant-count-button"
             class="inline-icon" Participants="@(Track.Participants)"></div>

        <svg id="instrumentation-button"
             class="inline-icon"
             viewBox="0 0 70 18"
             disabled="@(Disabled)"
             @onclick="@(() => NextInstrumentation.InvokeAsync())">
            <text y="80%" text-anchor="start">@(Track.Instrumentation)</text>
        </svg>

        <div id="rating-container" disabled="@(Disabled)">
            <StarRating 
                vertical
                values="Enumerable.Range(1, Track.Rating).ToList()"
                ratingChanged="(e) => ChangeRating.InvokeAsync(e.rating)"
                singleSelect
            ></StarRating>
        </div>

        <div id="instruments-container"
             disabled="@(Disabled)"
             @onclick="@(() => ChangeInstruments.InvokeAsync())">
            @if (Track.InstrumentTypes.Count() == 0)
            {
                <a id="add-instruments-link">Add Instruments</a>
            }

            @foreach (var instrument in Track.InstrumentTypes)
            {
                <div class="instrument-icon inline-icon" InstrumentType="@(instrument)"></div>
            }
        </div>
    </div>
</div>